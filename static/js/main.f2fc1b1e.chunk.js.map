{"version":3,"sources":["ui/templates/generic/styles.ts","ui/templates/generic/index.tsx","styles/defaults.ts","ui/atoms/overlay/styles.ts","ui/atoms/overlay/index.tsx","ui/atoms/field/index.tsx","ui/atoms/form/styles.ts","ui/atoms/form/index.tsx","ui/organisms/chat/styles.ts","ui/organisms/chat/index.tsx","ui/organisms/drawer/styles.ts","features/messages/model.ts","features/users/model.ts","lib/debounce.ts","api/socket.ts","api/index.ts","features/draw/model.ts","ui/organisms/drawer/index.tsx","ui/organisms/online/styles.ts","ui/organisms/online/index.tsx","ui/organisms/login/styles.ts","ui/organisms/login/index.tsx","pages/main/styles.ts","features/user/model.ts","lib/form-factories.ts","pages/main/model.ts","lib/validators.ts","lib/create-countdown.ts","pages/main/index.tsx","pages/login/model.ts","pages/login/styles.ts","pages/login/index.tsx","index.tsx"],"names":["GenericContainer","styled","div","GenericTemplate","children","GenericStyles","createGlobalStyle","normalize","OverlayContainer","Overlay","props","Field","store","config","className","label","name","placeholder","autofocus","isDisabled","$value","$error","changed","value","useStore","inputOptions","autoFocus","type","onChange","disabled","autoComplete","FormContainer","form","Form","handleSubmit","onSubmit","e","preventDefault","ChatContainer","MessagesContainer","Message","MessageHeader","MessageContent","NoMessagesContainer","MessageItem","msg","ts","React","isVisible","setVisible","aria-hidden","NoMessages","role","aria-label","Chat","history","length","map","item","key","DrawerContainer","DrawerCanvas","canvas","receiveMsg","createEvent","setChatHistory","$chatHistory","createStore","on","_","serverHistory","console","log","setUsersOnline","receiveTyping","stopTyping","$usersOnline","$usersTyping","usersList","typer","includes","watch","cb","wait","h","args","clearTimeout","setTimeout","debounce","filter","user","socket","io","sendMsg","createEffect","handler","message","emit","sendTyping","users","coordiantes","paintImage","chatHistory","drawImage","$image","x1","y1","x2","y2","coordinates","use","dpi","window","devicePixelRatio","drawLine","originalMousePosition","newMousePosition","ref","ctx","getContext","strokeStyle","lineJoin","lineWidth","beginPath","moveTo","x","y","lineTo","closePath","stroke","getCoordinates","pageX","offsetLeft","pageY","offsetTop","Drawer","cvs","paint","isPainting","painting","setCoordinates","current","width","scrollWidth","height","scrollHeight","startPainting","addEventListener","removeEventListener","handlePainting","newCoordinates","stopPainting","OnlineContainer","UserAvatar","Host","OnlineUsers","typing","host","id","data-typing","LoginContainer","LoginSubmit","button","Login","isError","isLoading","aria-disabled","data-disabled","MainContainer","Main","main","Aside","aside","RightPanel","MessageField","FormSubmit","input","signIn","credentials","$session","createField","initialValue","validator","handleReset","payload","currentTarget","substring","createForm","fields","$isValid","validateFields","$values","combine","reduce","acc","allStores","all","every","submitMessage","resetMessage","disableForm","$ticksLeft","$isCountdownEnd","msgField","loginForm","formStatus","start","abort","timeout","tick","timer","ms","Promise","resolve","$working","seconds","guard","source","pending","is","target","forward","from","to","done","params","createCountdown","$msg","Date","getTime","$isFormValid","isValid","isEnd","sample","prepend","MainPage","session","ticksLeft","isFormValid","randomEmoji","require","submitForm","nameField","random","count","character","test","LoginPageContainer","LoginField","LoginPage","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.f2fc1b1e.chunk.js","sourcesContent":["import styled from \"styled-components\";\n\nexport const GenericContainer = styled.div``;\n","import * as React from \"react\";\n\nimport { GenericContainer } from \"./styles\";\n\nexport const GenericTemplate: React.FC = ({ children }) => (\n  <GenericContainer>{children}</GenericContainer>\n);\n","import { createGlobalStyle } from \"styled-components\";\nimport { normalize } from \"styled-normalize\";\n\nexport const GenericStyles = createGlobalStyle`\n  ${normalize}\n\n  * {\n    margin: 0;\n    padding: 0;\n    outline: 0;\n    box-sizing: border-box;\n  }\n\n  :root {\n    --main-font: \"Roboto\", sans-serif;\n    --title-font: \"Roboto\", sans-serif;\n    --primary: #2B50EF;\n    --secondary: #fff;\n    --warning: #FE2B29;\n    --highlight: #F9F6DF;\n    --text-color: #848B97;\n    --text-color--secondary: #C4C9D5;\n    --title-color: #404346;\n    --link-active: #03a9f4;\n    --link-hover: #2196f3;\n    --border-color: #E3E4EC;\n    --body-bg: #F5F6FA;\n    --block-bg: #fff;\n    --red: #CD4040;\n    --green: #64CA95;\n    --blue: #157efb;\n    --box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.1);\n  }\n\n  body,\n  html {\n    font-family: var(--main-font);\n    color: var(--text-color);\n    background-color: var(--body-bg);\n    font-size: 62.5%;\n    line-height: 1.4;\n    font-weight: 400;\n    min-width: 320px;\n    margin-left: auto;\n    margin-right: auto;\n    width: 100%;\n    height: 100%;\n    -webkit-font-smoothing: antialiased;\n  }\n\n  section {\n    font-size: 1.6rem;\n  }\n\n  h1,\n  h2,\n  h3,\n  h4 {\n    font-family: var(--main-font);\n    line-height: 1.1;\n    color: var(--text-color);\n  }\n\n  p {\n    font-family: var(--text-font);\n  }\n\n  button {\n    border: 0;\n  }\n\n  input {\n    border: 0;\n  }\n\n  a {\n    border: 0;\n    transition: 0.2s;\n    text-decoration: none;\n    color: var(--black);\n  }\n\n  a:visited,\n  a:focus,\n  a:active,\n  a:hover {\n    outline: 0 none;\n  }\n\n  img {\n    border: 0;\n  }\n\n  menu,\n  ol,\n  ul {\n    margin: 0;\n    padding: 0;\n  }\n\n  li {\n    list-style-type: none;\n  }\n\n  section,\n  header,\n  footer {\n    font-size: 1.6rem;\n  }\n \n  \n`;\n","import styled from \"styled-components\";\n\nexport const OverlayContainer = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.35);\n  opacity: 0;\n  z-index: -1;\n  display: flex;\n  align-items: center;\n  align-content: center;\n  justify-content: center;\n\n  &[aria-hidden=\"true\"] {\n    opacity: 1;\n    z-index: 999;\n  }\n`;\n","import * as React from \"react\";\n\nimport { OverlayContainer } from \"./styles\";\n\ntype OverlayProps = {\n  onClick?: () => void;\n};\n\nexport const Overlay: React.FC<OverlayProps> = props => <OverlayContainer {...props} />;\n","import * as React from \"react\";\nimport styled from \"styled-components\";\n\nimport { Store, Event } from \"effector\";\nimport { useStore } from \"effector-react\";\n\nexport type FieldParams = {\n  className?: string;\n  store: {\n    name: string;\n    $value: Store<string>;\n    $error: Store<string | null>;\n    changed: Event<React.SyntheticEvent<HTMLInputElement>>;\n  };\n  config: {\n    label?: string;\n    name: string;\n    placeholder?: string;\n    autofocus?: boolean;\n    isDisabled?: boolean;\n  };\n};\n\nexport const Field: React.FC<FieldParams> = ({ store, config, className }) => {\n  const { label, name, placeholder, autofocus, isDisabled = false } = config;\n  const { $value, $error, changed } = store;\n\n  const value = useStore($value);\n  const error = useStore($error);\n  const isError = !!error;\n\n  const inputOptions = {\n    autoFocus: autofocus,\n    value,\n    type: name,\n    name,\n    placeholder,\n    onChange: changed,\n  };\n\n  return (\n    <div className={className}>\n      {label && <label>{label}</label>}\n      <input {...inputOptions} disabled={isDisabled} autoComplete=\"off\" />\n      {/* {isError && <Error>{error}</Error>} */}\n    </div>\n  );\n};\n\nexport const Error = styled.div`\n  width: 100%;\n  text-align: center;\n  font-size: 1.2rem;\n  line-height: 1;\n  margin-top: 12px;\n`;\n","import styled from \"styled-components\";\n\nexport const FormContainer = styled.form`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  max-height: 230px;\n  border-top: 1px solid var(--border-color);\n  background-color: var(--block-bg);\n  display: flex;\n  align-items: center;\n  min-height: 8vh;\n  transition: 0.3s;\n`;\n","import * as React from \"react\";\n\nimport { FormContainer } from \"./styles\";\n\ntype MessageFormProps = {\n  handleSubmit: () => void;\n};\n\nexport const Form: React.FC<MessageFormProps> = ({ handleSubmit, children }) => {\n  const onSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    handleSubmit && handleSubmit();\n  };\n\n  return <FormContainer onSubmit={onSubmit}>{children}</FormContainer>;\n};\n","import styled from \"styled-components\";\n\nexport const ChatContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  height: 100%;\n`;\n\nexport const MessagesContainer = styled.div`\n  display: flex;\n  flex-direction: column-reverse;\n  height: calc(100vh - 128px);\n  padding-top: 18px;\n  padding-bottom: 18px;\n  width: 100%;\n  overflow-y: auto;\n`;\n\nexport const Message = styled.div`\n  display: flex;\n  width: 100%;\n  padding: 16px;\n  padding-bottom: 0;\n`;\n\nexport const MessageHeader = styled.div`\n  width: 36px;\n  height: 36px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 2rem;\n  border-radius: 3px;\n  background-color: var(--body-bg);\n  letter-spacing: -2px;\n  margin-right: 12px;\n`;\n\nexport const MessageContent = styled.div`\n  width: 70%;\n  padding: 6px 30px 7px 0;\n  font-size: 1.4rem;\n  color: #000;\n`;\n\nexport const NoMessagesContainer = styled.div`\n  position: absolute;\n  font-size: 1.6rem;\n  margin: auto;\n  height: calc(100vh - 128px);\n  width: 100%;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: center;\n  align-items: center;\n  padding: 0 36px;\n  text-align: center;\n\n  span {\n    width: 100%;\n    text-align: center;\n    font-size: 3.6rem;\n  }\n`;\n","import * as React from \"react\";\n\nimport { MsgProps } from \"api/socket\";\n\nimport {\n  //\n  ChatContainer,\n  MessagesContainer,\n  Message,\n  MessageHeader,\n  MessageContent,\n  NoMessagesContainer,\n} from \"./styles\";\n\nconst MessageItem: React.FC<MsgProps> = ({ name, ts, msg }) => {\n  const [isVisible, setVisible] = React.useState(false);\n\n  React.useEffect(() => {\n    setVisible(true);\n  }, []);\n\n  return (\n    <Message aria-hidden={isVisible}>\n      <MessageHeader>{name}</MessageHeader>\n      <MessageContent>{msg}</MessageContent>\n    </Message>\n  );\n};\n\nconst NoMessages = () => {\n  return (\n    <NoMessagesContainer>\n      <span role=\"img\" aria-label=\"No messages\">\n        üôÇ\n      </span>\n      –í —á–∞—Ç–µ –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π, –±—É–¥—Ç–µ –ø–µ—Ä–≤—ã–º!\n    </NoMessagesContainer>\n  );\n};\n\ntype ChatProps = {\n  history: MsgProps[];\n};\n\nexport const Chat: React.FC<ChatProps> = ({ history, children }) => {\n  return (\n    <ChatContainer>\n      <MessagesContainer>\n        {history.length > 0 ? (\n          history.map((item, key) => <MessageItem key={key} {...item} />)\n        ) : (\n          <NoMessages />\n        )}\n      </MessagesContainer>\n      {children}\n    </ChatContainer>\n  );\n};\n","import styled from \"styled-components\";\n\nexport const DrawerContainer = styled.div`\n  display: flex;\n`;\n\nexport const DrawerCanvas = styled.canvas`\n  width: 100%;\n  min-height: 100vh;\n`;\n","import { createEvent, createStore } from \"effector\";\n\nimport * as API from \"api/socket\";\n\nexport const receiveMsg = createEvent<API.MsgProps>();\nexport const sendMsg = createEvent<API.MsgProps>();\nexport const setChatHistory = createEvent<API.MsgProps[]>();\n\nexport const $chatHistory = createStore<[] | API.MsgProps[]>([]);\n\n$chatHistory.on(setChatHistory, (_, serverHistory) => {\n  console.log(\"serverHistory\", serverHistory);\n  return serverHistory;\n});\n\n$chatHistory.on(receiveMsg, (history, msg) => {\n  console.log(\"receiveMsg\", msg);\n\n  return [msg, ...history];\n});\n","import { createStore, createEvent } from \"effector\";\nimport * as API from \"api/socket\";\nimport { debounce } from \"lib/debounce\";\n\nexport const setUsersOnline = createEvent<API.UsersProps[]>();\nexport const receiveTyping = createEvent<string>();\nexport const stopTyping = createEvent<string>();\n\nexport const $usersOnline = createStore<API.UsersProps[]>([]);\nexport const $usersTyping = createStore<string[]>([]);\n\n$usersOnline.on(setUsersOnline, (_, usersList) => usersList);\n\n$usersTyping.on(receiveTyping, (usersList, typer) => {\n  if (!usersList.includes(typer)) {\n    return [...usersList, typer];\n  }\n});\n\nreceiveTyping.watch(debounce(stopTyping, 1000));\n\n$usersTyping.on(stopTyping, (usersList, typer) => usersList.filter(user => user !== typer));\n","export function debounce<T extends Function>(cb: T, wait = 20) {\n  let h = 0;\n  let callable = (...args: any) => {\n    clearTimeout(h);\n    h = <any>setTimeout(() => cb(...args), wait);\n  };\n  return <T>(<any>callable);\n}\n","import io from \"socket.io-client\";\nimport { createEffect } from \"effector\";\n\nimport { receiveMsg, setChatHistory } from \"features/messages\";\nimport { setUsersOnline, receiveTyping, stopTyping } from \"features/users\";\nimport { paintImage } from \"features/draw\";\n\nimport { server } from \"./\";\n\nexport const socket = io(server);\n\nexport type UsersProps = {\n  name: string;\n  id: string;\n};\n\nexport type MsgProps = {\n  name: string | null;\n  ts: number;\n  msg: string;\n};\n\nexport type DrawningProps = {\n  x1: number;\n  y1: number;\n  x2: number;\n  y2: number;\n};\n\nexport type Credentials = {\n  name: string | null;\n};\n\nexport const signIn = (credentials: Credentials) => {\n  socket.emit(\"INIT_SESSION\", credentials);\n};\n\nexport const sendMsg = createEffect<MsgProps, void>({\n  handler(message) {\n    socket.emit(\"USER_MESSAGE\", message);\n  },\n});\n\nexport const sendTyping = createEffect<void, void>({\n  handler() {\n    socket.emit(\"USER_TYPING\");\n  },\n});\n\nsocket.on(\"USER_MESSAGE\", (msg: MsgProps) => {\n  receiveMsg(msg);\n});\n\nsocket.on(\"USER_TYPING\", (user: string) => {\n  receiveTyping(user);\n});\n\n//\nsocket.on(\"USERS_ONLINE\", (users: UsersProps[]) => setUsersOnline(users));\nsocket.on(\"USER_DRAWNING\", (coordiantes: DrawningProps) => paintImage(coordiantes));\n\nsocket.on(\"CHAT_HISTORY\", (chatHistory: MsgProps[]) => {\n  console.log(\"object\", chatHistory);\n  setChatHistory(chatHistory);\n});\n\nexport const userDraw = (coordiantes: DrawningProps) => {\n  socket.emit(\"USER_DRAWNING\", coordiantes);\n};\n","const isProduction = process.env.NODE_ENV === \"production\";\n\nexport const server = isProduction\n  ? \"https://sharades-server.herokuapp.com:7052\"\n  : \"http://localhost:8000\";\n\ntype RequestProps = {\n  method: \"GET\" | \"POST\" | \"PUT\" | \"DELETE\";\n  url: string;\n  params?: any;\n};\n\ntype HeadersProps = {\n  Accept: string;\n  \"Content-Type\": string;\n};\n\nexport const apiRequest = async ({ method, url, params }: RequestProps) => {\n  const headers: HeadersProps = {\n    Accept: \"application/json\",\n    \"Content-Type\": \"application/json\",\n  };\n\n  let response;\n\n  try {\n    response = await fetch(`/api/v1${url}`, {\n      method,\n      body: JSON.stringify(params),\n      headers,\n    });\n  } catch (error) {\n    throw new Error(error);\n  }\n\n  const headersType = response.headers.get(\"content-type\");\n\n  if (headersType && headersType.includes(\"application/json\")) {\n    const res = await response.json();\n    return res;\n  }\n};\n","import { createStore, createEffect, createEvent } from \"effector\";\nimport * as API from \"api/socket\";\n\nexport const drawImage = createEffect<API.DrawningProps, void>();\nexport const paintImage = createEvent<API.DrawningProps>();\n\nexport const $image = createStore({ x1: 0, y1: 0, x2: 0, y2: 0 });\n\n$image.on(paintImage, (_, coordinates) => coordinates);\n\ndrawImage.use(API.userDraw);\n","import * as React from \"react\";\nimport { useStore } from \"effector-react\";\nimport { DrawerContainer, DrawerCanvas } from \"./styles\";\nimport { drawImage, $image } from \"features/draw\";\n\nconst dpi = window.devicePixelRatio;\n\ntype PositionProps = {\n  x: number;\n  y: number;\n};\n\ntype EventProps = {\n  pageX: number;\n  pageY: number;\n};\n\nconst drawLine = (\n  originalMousePosition: PositionProps,\n  newMousePosition: PositionProps,\n  ref: HTMLCanvasElement\n) => {\n  const ctx = ref.getContext(\"2d\");\n\n  if (ctx) {\n    ctx.strokeStyle = \"#2b50ef\";\n    ctx.lineJoin = \"round\";\n    ctx.lineWidth = 12;\n\n    ctx.beginPath();\n    ctx.moveTo(originalMousePosition.x * dpi, originalMousePosition.y * dpi);\n    ctx.lineTo(newMousePosition.x * dpi, newMousePosition.y * dpi);\n    ctx.closePath();\n    ctx.stroke();\n  }\n};\n\nconst getCoordinates = (e: EventProps, ref: HTMLCanvasElement) => ({\n  x: e.pageX - ref.offsetLeft,\n  y: e.pageY - ref.offsetTop,\n});\n\nexport const Drawer = () => {\n  const cvs = React.useRef<HTMLCanvasElement | null>(null);\n  const paint = useStore($image);\n\n  const [isPainting, painting] = React.useState(false);\n  const [coordinates, setCoordinates] = React.useState<PositionProps | null>(null);\n\n  React.useEffect(() => {\n    const { current } = cvs;\n\n    if (current) {\n      drawLine({ x: paint.x1, y: paint.y1 }, { x: paint.x2, y: paint.y2 }, current);\n    }\n  }, [paint]);\n\n  React.useEffect(() => {\n    const { current } = cvs;\n\n    if (current) {\n      current.width = current.scrollWidth * dpi;\n      current.height = current.scrollHeight * dpi;\n    }\n  }, []);\n\n  const startPainting = React.useCallback(e => {\n    const { current } = cvs;\n    if (current) {\n      const coordinates = getCoordinates(e, current);\n      if (coordinates) {\n        painting(true);\n        setCoordinates(coordinates);\n      }\n    }\n  }, []);\n\n  React.useEffect(() => {\n    const { current } = cvs;\n    if (current) {\n      current.addEventListener(\"mousedown\", startPainting);\n      return () => {\n        current.removeEventListener(\"mousedown\", startPainting);\n      };\n    }\n  }, [startPainting]);\n\n  const handlePainting = React.useCallback(\n    e => {\n      const { current } = cvs;\n\n      if (current && isPainting) {\n        const newCoordinates = getCoordinates(e, current);\n        if (coordinates && newCoordinates) {\n          drawLine(coordinates, newCoordinates, current);\n          drawImage({\n            x1: coordinates.x,\n            y1: coordinates.y,\n            x2: newCoordinates.x,\n            y2: newCoordinates.y,\n          });\n          setCoordinates(newCoordinates);\n        }\n      }\n    },\n    [isPainting, coordinates]\n  );\n\n  React.useEffect(() => {\n    const { current } = cvs;\n    if (current) {\n      current.addEventListener(\"mousemove\", handlePainting);\n      return () => {\n        current.removeEventListener(\"mousemove\", handlePainting);\n      };\n    }\n  }, [handlePainting]);\n\n  const stopPainting = React.useCallback(() => {\n    painting(false);\n    setCoordinates(null);\n  }, []);\n\n  React.useEffect(() => {\n    const { current } = cvs;\n\n    if (current) {\n      current.addEventListener(\"mouseup\", stopPainting);\n      current.addEventListener(\"mouseleave\", stopPainting);\n      return () => {\n        current.removeEventListener(\"mouseup\", stopPainting);\n        current.removeEventListener(\"mouseleave\", stopPainting);\n      };\n    }\n  }, [stopPainting]);\n\n  return (\n    <DrawerContainer>\n      <DrawerCanvas ref={cvs} />\n    </DrawerContainer>\n  );\n};\n","import styled from \"styled-components\";\n\nexport const OnlineContainer = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  padding: 12px;\n`;\n\nexport const UserAvatar = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 3.6rem;\n  height: 3.6rem;\n  background: rgba(0, 0, 0, 0.1);\n  margin: 0.6rem;\n  border-radius: 3px;\n  font-size: 2.4rem;\n  letter-spacing: -2px;\n  position: relative;\n\n  &:before {\n    content: \"üí¨\";\n    position: absolute;\n    top: -8px;\n    right: -12px;\n    font-size: 1.6rem;\n    transition: 0.3s;\n  }\n\n  &[data-typing=\"false\"] {\n    &:before {\n      opacity: 0;\n    }\n  }\n\n  &[data-typing=\"true\"] {\n    &:before {\n      opacity: 1;\n    }\n  }\n`;\n\nexport const Host = styled(UserAvatar)`\n  position: relative;\n\n  &:before {\n    content: \"üëë\";\n    position: absolute;\n    top: -17px;\n    font-size: 3rem;\n    left: auto;\n    right: auto;\n    margin: 0 auto;\n  }\n\n  &:after {\n    content: \"\";\n    position: absolute;\n    bottom: -16px;\n    width: 100%;\n    height: 1px;\n    background-color: rgba(0, 0, 0, 0.1);\n  }\n\n  width: 5.6rem;\n  height: 5.6rem;\n  font-size: 3.6rem;\n  margin-bottom: 24px;\n`;\n","import * as React from \"react\";\n\nimport { OnlineContainer, UserAvatar, Host } from \"./styles\";\n\nimport * as API from \"api/socket\";\n\ntype UsersProps = {\n  users: API.UsersProps[];\n  host: string;\n  typing: string[];\n};\n\nexport const OnlineUsers: React.FC<UsersProps> = ({ users, typing, host }) => {\n  return (\n    <OnlineContainer>\n      <Host>{host}</Host>\n      {users.map(({ name, id }, key) => (\n        <UserAvatar key={key} data-typing={typing.includes(id)}>\n          {name}\n        </UserAvatar>\n      ))}\n    </OnlineContainer>\n  );\n};\n","import styled from \"styled-components\";\n\nexport const LoginContainer = styled.form`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  background-color: var(--block-bg);\n  border-radius: 6px;\n  padding: 24px;\n  max-width: 350px;\n`;\n\nexport const LoginSubmit = styled.button`\n  margin-top: 24px;\n  font-size: 1.6rem;\n  line-height: 3.6rem;\n  background-color: var(--primary);\n  color: #fff;\n  padding: 0 24px;\n  border-radius: 3px;\n\n  &[data-disabled=\"true\"] {\n    opacity: 0.7;\n  }\n`;\n","import * as React from \"react\";\n\nimport { LoginContainer, LoginSubmit } from \"./styles\";\n\ntype LoginProps = {\n  handleSubmit?: React.FormEventHandler<HTMLFormElement>;\n  isError?: boolean;\n  isLoading: boolean;\n};\n\nexport const Login: React.FC<LoginProps> = ({\n  children,\n  isError = false,\n  handleSubmit,\n  isLoading = false,\n}) => {\n  const onSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    handleSubmit && handleSubmit(e);\n  };\n\n  return (\n    <LoginContainer onSubmit={onSubmit} aria-disabled={isLoading}>\n      {children}\n      <LoginSubmit type=\"submit\" name=\"submit\" data-disabled={isError}>\n        –í–æ–π—Ç–∏\n      </LoginSubmit>\n    </LoginContainer>\n  );\n};\n","import styled from \"styled-components\";\n\nimport { Field } from \"ui/atoms\";\n\nexport const MainContainer = styled.div`\n  display: flex;\n`;\n\nexport const Main = styled.main`\n  width: 100%;\n  min-height: 100vh;\n  position: relative;\n`;\n\nexport const Aside = styled.aside`\n  width: 100%;\n  max-width: 320px;\n  height: calc(100vh - 72px);\n  background-color: var(--block-bg);\n  position: absolute;\n  right: 96px;\n  top: 0;\n  bottom: 0;\n  margin: 36px;\n  border-radius: 5px;\n  box-shadow: var(--box-shadow);\n  z-index: 100;\n`;\n\nexport const RightPanel = styled.div`\n  width: 96px;\n  height: calc(100vh - 124px);\n  background-color: var(--primary);\n  position: absolute;\n  right: 0;\n  margin: 62px 36px;\n  border-radius: 0 5px 5px 0;\n  box-shadow: var(--box-shadow);\n`;\n\nexport const MessageField = styled(Field)`\n  font-size: 1.6rem;\n  line-height: 8vh;\n  padding: 0 24px 0 60px;\n  width: 100%;\n`;\n\nexport const UserAvatar = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 3.6rem;\n  height: 3.6rem;\n  background-color: rgba(0, 0, 0, 0.05);\n  border-radius: 3px;\n  font-size: 2.4rem;\n  letter-spacing: -2px;\n  position: absolute;\n  z-index: 100;\n  top: 12px;\n  left: 12px;\n`;\n\nexport const FormSubmit = styled.input`\n  font-size: 1.4rem;\n  line-height: 1em;\n  min-height: 5vh;\n  background-color: var(--primary);\n  color: #fff;\n  padding: 0 12px;\n  border-radius: 3px;\n  position: absolute;\n  right: 12px;\n  transition: 0.3s;\n\n  &[aria-disabled=\"true\"] {\n    opacity: 0.7;\n  }\n\n  &[aria-disabled=\"false\"] {\n    opacity: 1;\n  }\n`;\n","import { createStore, createEffect } from \"effector\";\nimport * as API from \"api/socket\";\n\nexport const signIn = createEffect<string, void>();\n\nsignIn.use((name: string) => API.signIn({ name }));\n\nexport const $session = createStore<API.Credentials>({\n  name: null,\n});\n\n$session.on(signIn, (_, name: string) => ({ name }));\n","import { createStore, createEvent, combine, Store, Event } from \"effector\";\n\ntype CreateFieldProps = {\n  name: string;\n  initialValue?: string;\n  length?: number;\n  validator?: (value: string) => string | null;\n  handleReset?: Event<any>;\n};\n\nexport type CreateFieldResult = {\n  name: string;\n  $value: Store<string>;\n  $error: Store<string | null>;\n  changed: Event<React.SyntheticEvent<HTMLInputElement>>;\n};\n\nexport const createField = ({\n  name,\n  length,\n  initialValue = \"\",\n  validator,\n  handleReset,\n}: CreateFieldProps): CreateFieldResult => {\n  const changed = createEvent<React.SyntheticEvent<HTMLInputElement>>(`${name}Changed`);\n\n  const $value = createStore(initialValue, { name: `${name}Store` });\n\n  const $error = validator ? $value.map(validator) : createStore<null | string>(null);\n\n  $value.on(changed, (_, payload) => payload.currentTarget.value.substring(0, length));\n\n  if (handleReset) {\n    $value.on(handleReset, () => \"\");\n  }\n\n  return { name, $value, $error, changed };\n};\n\ntype CreateFormProps = {\n  name: string;\n  fields: Array<CreateFieldResult>;\n  validator?: Store<boolean>;\n};\n\ntype CreateFormResults = {\n  $values: Store<{ [key: string]: string }>;\n  $isValid: Store<boolean>;\n  name: string;\n};\n\nexport const createForm = ({ name, fields, validator }: CreateFormProps): CreateFormResults => {\n  const $isValid = validator || validateFields(fields);\n\n  const $values = combine(\n    fields.reduce((acc, { $value, name }) => ({ ...acc, ...{ [name]: $value } }), {})\n  );\n\n  return { name, $values, $isValid };\n};\n\nexport const validateFields = (fields: CreateFieldResult[]) => {\n  const allStores = fields.map(({ $error }) => $error);\n  return combine(allStores, all => all.every((value: string | null) => !value));\n};\n","import { createEvent, createStore, guard, sample, combine, forward } from \"effector\";\n\nimport { sendMsg, sendTyping } from \"api/socket\";\nimport { $session } from \"features/user\";\n\nimport { createField, createForm } from \"lib/form-factories\";\n\nimport { createCountdown } from \"lib/create-countdown\";\nimport { validateMessage } from \"lib/validators\";\n\nexport const submitMessage = createEvent<void>();\n\nconst resetMessage = createEvent<void>();\nconst disableForm = createEvent<void | number>();\n\nexport const $ticksLeft = createStore<number>(0);\nconst $isCountdownEnd = createStore<boolean>(true);\n\nexport const msgField = createField({\n  name: \"message\",\n  handleReset: resetMessage,\n  validator: validateMessage,\n});\n\nexport const loginForm = createForm({\n  name: \"messageForm\",\n  fields: [msgField],\n});\n\nconst formStatus = createCountdown(\"formSubmit\", {\n  start: disableForm,\n});\n\n$ticksLeft.on(formStatus.tick, (_, seconds) => seconds);\n$isCountdownEnd.on(formStatus.tick, (_, seconds) => seconds <= 0);\n\nconst $msg = combine(msgField.$value, $session, (message, user) => ({\n  name: user.name,\n  ts: new Date().getTime(),\n  msg: message,\n}));\n\nexport const $isFormValid = combine(\n  loginForm.$isValid,\n  $isCountdownEnd,\n  (isValid, isEnd) => isValid && isEnd\n);\n\nguard({\n  source: sample($msg, submitMessage),\n  filter: $isFormValid,\n  target: sendMsg,\n});\n\nforward({ from: msgField.changed, to: sendTyping });\n\nforward({ from: sendMsg, to: resetMessage });\nforward({ from: sendMsg, to: disableForm.prepend(() => 5) });\n","export const validateEmoji = (name: string) => {\n  const emojiRejex = /(\\u00a9|\\u00ae|[\\u2000-\\u3300]|\\ud83c[\\ud000-\\udfff]|\\ud83d[\\ud000-\\udfff]|\\ud83e[\\ud000-\\udfff])/;\n\n  if (!emojiRejex.test(name)) {\n    return \"–¢–æ–ª—å–∫–æ Emoji\";\n  }\n\n  return null;\n};\n\nexport const validateMessage = (msg: string) => {\n  if (msg.length < 1) {\n    return \"–ü—É—Å—Ç–æ–µ –ø–æ–ª–µ\";\n  }\n\n  return null;\n};\n","import {\n  createStore,\n  createEffect,\n  createEvent,\n  forward,\n  guard,\n  Event,\n} from 'effector';\n\ntype CreateTimerProps = {\n  start: Event<void | number>;\n  abort?: Event<void>;\n  timeout?: number;\n};\n\ntype CreateTimerResult = {\n  tick: Event<number>;\n};\n\nconst wait = (ms: number): Promise<void> => {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\nexport const createCountdown = (\n  name: string,\n  {\n    start,\n    abort = createEvent(`${name}Reset`),\n    timeout = 1000,\n  }: CreateTimerProps,\n): CreateTimerResult => {\n  const tick = createEvent<number>(`${name}Tick`);\n  const timer = createEffect<number, void>(`${name}Timer`).use(() =>\n    wait(timeout),\n  );\n\n  const $working = createStore(true, { name: `${name}Working` });\n\n  $working\n    .on(timer, (_, seconds) => seconds > 0)\n    .on(abort, () => false)\n    .on(start, () => true);\n\n  guard({\n    source: start,\n    filter: timer.pending.map((is) => !is),\n    target: tick,\n  });\n\n  forward({\n    from: tick,\n    to: timer,\n  });\n\n  guard({\n    source: timer.done.map(({ params }) => params - 1),\n    filter: $working,\n    target: tick,\n  });\n\n  return { tick };\n};\n","import * as React from \"react\";\nimport { useStore } from \"effector-react\";\n\nimport { Form } from \"ui/atoms\";\nimport { Chat, Drawer, OnlineUsers } from \"ui/organisms\";\n\nimport {\n  MainContainer,\n  Main,\n  Aside,\n  RightPanel,\n  MessageField,\n  UserAvatar,\n  FormSubmit,\n} from \"./styles\";\n\nimport { $chatHistory } from \"features/messages\";\nimport { $session } from \"features/user\";\nimport { $usersOnline, $usersTyping } from \"features/users\";\n\nimport { submitMessage, msgField, $ticksLeft, $isFormValid } from \"./model\";\n\nexport const MainPage = () => {\n  const history = useStore($chatHistory);\n  const session = useStore($session);\n  const users = useStore($usersOnline);\n  const typing = useStore($usersTyping);\n  const ticksLeft = useStore($ticksLeft);\n  const isFormValid = useStore($isFormValid);\n\n  const handleSubmit = () => {\n    submitMessage();\n  };\n\n  return (\n    <MainContainer>\n      <Main>\n        <Drawer />\n      </Main>\n      <Aside>\n        <Chat history={history}>\n          <Form handleSubmit={handleSubmit}>\n            <UserAvatar>{session.name}</UserAvatar>\n            <MessageField\n              store={msgField}\n              config={{\n                name: \"message\",\n                placeholder: \"–°–æ–æ–±—â–µ–Ω–∏–µ...\",\n                autofocus: true,\n              }}\n            />\n            <FormSubmit\n              type=\"submit\"\n              value={ticksLeft <= 0 ? \"Send\" : `00: 0${ticksLeft}`}\n              aria-disabled={!isFormValid}\n            />\n          </Form>\n        </Chat>\n      </Aside>\n      <RightPanel>\n        <OnlineUsers users={users} typing={typing} host=\"üò±\" />\n      </RightPanel>\n    </MainContainer>\n  );\n};\n","import { createEvent, guard, sample } from \"effector\";\n\nimport { createField, createForm } from \"lib/form-factories\";\nimport { validateEmoji } from \"lib/validators\";\n\nimport { signIn } from \"features/user\";\n\nconst randomEmoji = require(\"random-emoji\");\n\nexport const submitForm = createEvent<React.FormEvent<HTMLFormElement>>();\n\nconst emoji = randomEmoji.random({ count: 1 });\n\nexport const nameField = createField({\n  name: \"name\",\n  initialValue: emoji[0].character,\n  validator: validateEmoji,\n});\n\nexport const loginForm = createForm({\n  name: \"loginForm\",\n  fields: [nameField],\n});\n\nguard({\n  source: sample(nameField.$value, submitForm),\n  filter: loginForm.$isValid,\n  target: signIn,\n});\n","import styled from \"styled-components\";\n\nimport { Field } from \"ui/atoms\";\n\nexport const LoginPageContainer = styled.div`\n  display: flex;\n  align-items: center;\n  align-content: center;\n  justify-content: center;\n  width: 100%;\n  min-height: 100vh;\n  background-color: var(--primary);\n`;\n\nexport const LoginField = styled(Field)`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  width: 100%;\n\n  input {\n    text-align: center;\n    width: 64px;\n    height: 64px;\n    font-size: 3.2rem;\n    line-height: 64px;\n    background-color: rgba(0, 0, 0, 0.05);\n    border-radius: 3px;\n    margin: 0 6px;\n    transition: 0.3s;\n    cursor: pointer;\n\n    &:hover {\n      background-color: var(--primary);\n    }\n  }\n\n  label {\n    width: 100%;\n    text-align: center;\n    font-size: 1.6rem;\n    margin-bottom: 12px;\n  }\n`;\n","import * as React from \"react\";\n\nimport { Overlay } from \"ui/atoms\";\nimport { Login } from \"ui/organisms\";\n\nimport { nameField, submitForm } from \"./model\";\nimport { LoginPageContainer, LoginField } from \"./styles\";\n\nexport const LoginPage = () => {\n  return (\n    <LoginPageContainer>\n      <Overlay aria-hidden=\"true\">\n        <Login handleSubmit={submitForm} isLoading={false}>\n          <LoginField\n            store={nameField}\n            config={{\n              label: \"–ò–º—è:\",\n              name: \"name\",\n            }}\n          />\n        </Login>\n      </Overlay>\n    </LoginPageContainer>\n  );\n};\n","import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\n\nimport { useStore } from \"effector-react\";\n\nimport { GenericTemplate } from \"ui/templates\";\nimport { GenericStyles } from \"styles\";\n\nimport { MainPage, LoginPage } from \"pages\";\nimport { $session } from \"features/user\";\n\nconst App = () => {\n  const session = useStore($session);\n\n  return (\n    <>\n      <GenericStyles />\n      <GenericTemplate>{session.name ? <MainPage /> : <LoginPage />}</GenericTemplate>\n    </>\n  );\n};\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}